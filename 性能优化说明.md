# 性能优化说明

## 已实施的优化

我已经对照片加载和渲染进行了以下优化，以解决卡顿问题：

### 1. 纹理压缩
- **自动压缩照片尺寸**：所有照片在加载时自动压缩到最大 1024x1024 像素
- **JPEG 质量优化**：使用 85% 质量压缩，平衡视觉效果和文件大小
- **效果**：大幅减少内存占用和 GPU 负担

### 2. 渲染优化
- **智能朝向更新**：照片只在相机位置显著变化时才更新朝向，减少每帧计算
- **纹理过滤器优化**：使用 mipmap 和高效的线性过滤
- **材质优化**：禁用不必要的色调映射等计算

### 3. 数量限制
- **照片数量**：从最多 20 张减少到 8 张，降低渲染负担

## 如果仍然卡顿，可以进一步优化

### 方法 1：减少照片数量

编辑 `components/PhotoPlanes.tsx`，找到这一行：
```typescript
const MAX_PHOTOS = Math.min(photoPaths.length, 8);
```
将 `8` 改为更小的数字，例如 `4` 或 `6`。

### 方法 2：降低纹理分辨率

编辑 `components/PhotoPlanes.tsx`，找到这一行：
```typescript
const MAX_TEXTURE_SIZE = 1024; // 最大纹理尺寸 1024x1024
```
可以改为 `512` 或 `768` 以进一步提升性能。

### 方法 3：压缩原始照片文件

在添加到项目之前，使用图片压缩工具（如 TinyPNG、ImageOptim）压缩照片：
- 目标文件大小：每张照片 < 500KB
- 推荐分辨率：1024x1024 或更小

### 方法 4：使用 WebP 格式

将照片转换为 WebP 格式可以进一步减小文件大小：
```bash
# 使用 imagemagick 转换（如果已安装）
convert input.jpg -quality 85 output.webp
```

然后在代码中更新文件扩展名。

### 方法 5：降低 Canvas 像素比

编辑 `components/Experience.tsx`，找到：
```typescript
dpr={[1, 1.5]} // 降低像素比提升性能
```
可以改为 `dpr={[1, 1]}` 以降低渲染分辨率。

## 性能监控

打开浏览器开发者工具（F12），在 Console 中可以看到：
- 照片加载进度
- 压缩后的照片尺寸
- 加载完成提示

如果看到照片尺寸仍然很大，说明压缩可能没有生效，检查浏览器控制台是否有错误。

## 建议

对于最佳性能：
1. **照片数量**：4-6 张
2. **纹理尺寸**：512x512 或 768x768
3. **文件大小**：每张 < 300KB
4. **格式**：JPEG（质量 80-85%）或 WebP

这样可以在保持良好视觉效果的同时获得流畅的 60 FPS 性能。


